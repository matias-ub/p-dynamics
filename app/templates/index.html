{% extends "base.html" %}

{% block title %}Inicio - Parejas{% endblock %}

{% block content %}
<div class="hero-section text-center py-5">
    <div class="container">
        <h1 class="display-3 fw-bold mb-4">ðŸ’‘ Parejas</h1>
        <p class="lead mb-3">Una pregunta diaria para conectar y entenderse mejor</p>
        
        {% if question %}
        <div class="row justify-content-center mt-5">
            <div class="col-md-8">
                <div class="card shadow-lg">
                    <div class="card-body p-5">
                        <h3 class="mb-4">Pregunta del DÃ­a</h3>
                        <p class="lead mb-5">{{ question.text }}</p>
                        
                        <button id="startAnswering" class="btn btn-primary btn-lg px-5">
                            Responder
                        </button>
                    </div>
                </div>
            </div>
        </div>
        {% else %}
        <div class="alert alert-warning mt-5">
            No hay pregunta disponible hoy. Â¡Vuelve maÃ±ana!
        </div>
        {% endif %}
        
        <div class="mt-5 pt-5">
            <h3 class="mb-4">Â¿CÃ³mo funciona?</h3>
            <div class="row text-start">
                <div class="col-md-4 mb-3">
                    <div class="d-flex align-items-start">
                        <div class="flex-shrink-0 me-3">
                            <span class="badge bg-primary rounded-circle p-3">1</span>
                        </div>
                        <div>
                            <h5>Responde la pregunta</h5>
                            <p class="text-muted">Cada dÃ­a hay una nueva pregunta. Responde quÃ© elegirÃ­as tÃº.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="d-flex align-items-start">
                        <div class="flex-shrink-0 me-3">
                            <span class="badge bg-primary rounded-circle p-3">2</span>
                        </div>
                        <div>
                            <h5>Predice su respuesta</h5>
                            <p class="text-muted">Â¿QuÃ© crees que elegirÃ¡ tu pareja? Demuestra cuÃ¡nto lo/la conoces.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="d-flex align-items-start">
                        <div class="flex-shrink-0 me-3">
                            <span class="badge bg-primary rounded-circle p-3">3</span>
                        </div>
                        <div>
                            <h5>MantÃ©n la racha</h5>
                            <p class="text-muted">Respondan todos los dÃ­as y mantengan su racha activa ðŸ”¥</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('startAnswering')?.addEventListener('click', async () => {
    const button = document.getElementById('startAnswering');
    button.disabled = true;
    button.textContent = 'Preparando...';
    
    try {
        // Create room (session is managed by backend cookies)
        const roomResponse = await fetch('/api/rooms', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        
        if (roomResponse.ok) {
            const roomData = await roomResponse.json();
            window.location.href = `/question/${roomData.id}`;
        } else {
            const error = await roomResponse.json();
            alert('Error: ' + error.detail);
            button.disabled = false;
            button.textContent = 'Responder';
        }
    } catch (error) {
        alert('Error: ' + error.message);
        button.disabled = false;
        button.textContent = 'Responder';
    }
});
</script>
{% endblock %}
